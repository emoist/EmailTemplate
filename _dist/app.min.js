var defaultFontFamily=["inherit","Georgia, serif","'Palatino Linotype', 'Book Antiqua', Palatino, serif","'Times New Roman', Times, serif","Arial, Helvetica, sans-serif","'Arial Black', Gadget, sans-serif","'Comic Sans MS', cursive, sans-serif","Impact, Charcoal, sans-serif","'Lucida Sans Unicode', 'Lucida Grande', sans-serif","Tahoma, Geneva, sans-serif","'Trebuchet MS', Helvetica, sans-serif","Verdana, Geneva, sans-serif","'Courier New', Courier, monospace","'Lucida Console', Monaco, monospace"],emailBuilderConfigurations={assetsPath:"http://localhost:9000/assets",authPath:"auth/layouts",containerPath:"container/layouts",defaultLayout:"modern",defaultSkin:"dark",layoutsPath:"layouts",urlToUploadImage:"//uploads.im/api",tinymceBaseUrl:"/bower_components/tinymce",translateTemplateUrl:"i18n/{part}/{lang}.json",mjmlPublicKey:"",mjmlApplicationId:"",mjmlCompileAdress:"/compile",buildFolder:"_dist",builderTitle:"Angular email builder",builderDescription:"",UA:"",exportHtml:!0,importHtml:!0,deleteAllBlocks:!0,trackEvents:!1,includeMailchimpMergeTags:!1,defaults:{newEmailName:"My new email template",emailOptions:{paddingTop:"15px",paddingRight:"10px",paddingBottom:"15px",paddingLeft:"10px",backgroundColor:"#fff",border:"1px solid #999 dashed"}},disableBlocks:[],blocks:{title:{type:"title",sort:1,element:{type:"title",icon:"&#xE165;",primary_head:"builder_el_title",second_head:"builder_el_title_comment"},defaultOptions:{align:"center",title:"Enter your title here",subTitle:"Subtitle",padding:["30px","15px","30px","15px"],backgroundColor:"#fff",font:{weight:"normal",weightOptions:["bold","bolder","lighter","inherit","initial","normal",100,200,300,400,500,600,700,800,900],family:"Arial, Helvetica, sans-serif",familyOptions:defaultFontFamily},color:"#444444"},template:'<table class="main" width="100%" cellspacing="0" cellpadding="0" border="0" align="center" style="display: table; background-color: {{ element.options.backgroundColor }}" data-type="title">\n    <tbody>\n    <tr>\n        <td align="{{  element.options.align  }}" class="title" style="padding:{{  element.options.padding | arrToPadding   }}; color: #757575;" data-block-id="background">\n            <h1 style="font-family: {{ element.options.font.family }};font-weight:  {{ element.options.font.weight }}; margin: 0; color: {{ element.options.color }};" ng-if="element.options.title.length" data-block-id="main-title">{{  element.options.title  }}</h1>\n            <h4 style="font-family: {{ element.options.font.family }};font-weight: {{ element.options.font.weight }}; margin-bottom: 0; color: {{ element.options.color }};" ng-if="element.options.subTitle.length" data-block-id="sub-title">{{  element.options.subTitle  }}</h4>\n        </td>\n    </tr>\n    </tbody>\n</table>'},button:{type:"button",sort:4,element:{type:"button",icon:"&#xE913;",primary_head:"builder_el_button",second_head:"builder_el_button_comment"},defaultOptions:{align:"center",padding:["12px","20px","12px","20px"],margin:["15px","15px","15px","15px"],buttonText:"Click me",url:"#",buttonBackgroundColor:"#3498DB",backgroundColor:"#ffffff",border:{size:1,radius:3,color:"#3498DB",style:"solid",styleOptions:["dotted","solid","dashed"]},fullWidth:!1,font:{size:15,color:"#ffffff",weight:"normal",weightOptions:["bold","bolder","lighter","inherit","initial","normal",100,200,300,400,500,600,700,800,900],family:"inherit",familyOptions:defaultFontFamily}},template:'<table class="main" width="100%" cellspacing="0" cellpadding="0" border="0" bgcolor="#FFFFFF" align="center" style="display: table; background-color: {{element.options.backgroundColor}};" data-type="button">\n    <tbody>\n    <tr>\n        <td class="buttons-full-width">\n            <table cellspacing="0" cellpadding="0" border="0" align="center" width="100%" style="text-align: {{ element.options.align }}" class="button">\n                <tbody>\n                <tr>\n                    <td class="button" style="padding: {{element.options.margin | arrToPadding}};">\n                        <a style="background-color: {{element.options.buttonBackgroundColor}};color: {{element.options.font.color}};font-family: {{element.options.font.family}};font-size: {{element.options.font.size}}px;line-height:19px;display: {{element.options.fullWidth ? \'block\' : \'inline-block\'}};border-radius: {{element.options.border.radius}}px;border: {{element.options.border.size}}px  {{element.options.border.style}}  {{element.options.border.color}};text-align: center;text-decoration: none;font-weight:  {{element.options.font.weight}};margin: 0; width: auto; padding: {{element.options.padding | arrToPadding}};" class="button-1" href="{{ element.options.url }}" data-default="1">{{ element.options.buttonText }}</a>                   \x3c!--[if mso]>             </center>           </v:roundrect>         <![endif]--\x3e\n                    </td>\n                </tr>\n                </tbody>\n            </table>\n        </td>\n    </tr>\n    </tbody>\n</table>'},text:{type:"text",sort:2,element:{type:"text",icon:"&#xE8EE;",primary_head:"builder_el_text",second_head:"builder_el_text_comment"},defaultOptions:{padding:["10px","15px","10px","15px"],backgroundColor:"#ffffff",font:{family:"inherit",familyOptions:defaultFontFamily},text:'<p style="margin: 0">Lorem ipsum dolor sit amet, consectetur adipisci elit, sed eiusmod tempor incidunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur. Quis aute iure reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint obcaecat cupiditat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. </p>'},template:'<table class="main" width="100%" cellspacing="0" cellpadding="0" border="0" style="display: table; background-color: {{element.options.backgroundColor}}" align="center" data-type="text-block">\n    <tbody>\n    <tr>\n        <td class="block-text" data-block-id="background" data-clonable="true" align="left" style="padding:{{element.options.padding | arrToPadding}}; font-size: 13px; color: #000000; line-height: 20px;font-family: {{element.options.font.family}}"\n      ui-tinymce="tinymceOptions"    ng-model="element.options.text">\n        </td>\n    </tr>\n    </tbody>\n</table>'},social:{type:"social",sort:10,element:{type:"social",icon:"share",primary_head:"social_icons",second_head:"social_icons_comment"},defaultOptions:{align:"center",padding:["10px","15px","10px","15px"],backgroundColor:"#eeeeee",links:{facebook:{link:"https://www.facebook.com/envato",active:!0},twitter:{link:"https://twitter.com/envatomarket",active:!0},linkedin:{link:"",active:!1},youtube:{link:"https://www.youtube.com/user/Envato",active:!0}}},template:'<table class="main" align="center" width="100%" cellspacing="0" cellpadding="0" border="0" ng-style="{backgroundColor: element.options.backgroundColor}" style="display: table;" data-type="social-links">\n    <tbody>\n    <tr>\n        <td class="social" align="{{element.options.align}}" style="padding: {{ element.options.padding | arrToPadding  }}">\n            <a href="{{element.options.links.facebook.link}}" target="_blank" style="border: none;text-decoration: none;" class="facebook">\n                <img border="0" ng-if="element.options.links.facebook.active" src="assets/social/facebook.png">\n            </a>\n            <a href="{{element.options.links.twitter.link}}" target="_blank" style="border: none;text-decoration: none;" class="twitter">\n                <img border="0" ng-if="element.options.links.twitter.active" src="assets/social/twitter.png">\n            </a>\n            <a href="{{element.options.links.linkedin.link}}" target="_blank" style="border: none;text-decoration: none;" class="linkedin">\n                <img border="0" ng-if="element.options.links.linkedin.active" src="assets/social/linkedin.png">\n            </a>\n            <a href="{{element.options.links.youtube.link}}" target="_blank" style="border: none;text-decoration: none;" class="youtube">\n                <img border="0" ng-if="element.options.links.youtube.active" src="assets/social/youtube.png">\n            </a>\n        </td>\n    </tr>\n    </tbody>\n</table>'},divider:{type:"divider",sort:3,element:{type:"divider",icon:"&#xE8E9;",primary_head:"builder_el_divider",second_head:"builder_el_divider_comment"},defaultOptions:{padding:["15px","15px","15px","15px"],backgroundColor:"#ffffff",border:{size:1,style:"solid",styleOptions:["solid","dashed","dotted"],color:"#DADFE1"}},template:'<table class="main" width="100%" style="border: 0; display: table; background-color: {{element.options.backgroundColor}};" cellspacing="0" cellpadding="0" border="0" align="center" data-type="divider">\n    <tbody>\n    <tr>\n        <td class="divider-simple" style="padding: {{ element.options.padding | arrToPadding  }};">\n            <table width="100%" cellspacing="0" cellpadding="0" border="0" style="border-top: {{element.options.border.size}}px {{element.options.border.style}} {{element.options.border.color}};">\n                <tbody>\n                <tr>\n                    <td width="100%"></td>\n                </tr>\n                </tbody>\n            </table>\n        </td>\n    </tr>\n    </tbody>\n</table>'},image:{type:"image",sort:5,element:{type:"image",icon:"&#xE40B;",primary_head:"builder_el_image",second_head:"builder_el_image_comment"},defaultOptions:{align:"center",padding:["15px","15px","15px","15px"],image:"assets/350x150.jpg",width:"370",backgroundColor:"#ffffff",altTag:"",linkTo:{type:"none",typeOptions:["link","email","none"],link:""}},template:'<table width="100%" class="main" cellspacing="0" cellpadding="0" border="0" align="center" style="display: table; background-color: {{element.options.backgroundColor}};" data-type="image">\n    <tbody>\n    <tr>\n        <td align="{{ element.options.align }}" style="padding: {{ element.options.padding | arrToPadding  }};" class="image">\n          <img border="0" align="one_image" image-with-link link="element.options.linkTo" style="display:block;max-width:100%;" ng-style="{width: element.options.width}" alt="{{element.options.altTag}}" ng-src="{{ element.options.image }}" tabindex="0">       </td>\n    </tr>\n    </tbody>\n</table>'},imageTextRight:{type:"imageTextRight",sort:6,element:{type:"imageTextRight",icon:"format_textdirection_l_to_r",primary_head:"builder_el_image_text_right",second_head:"builder_el_image_text_right_comment"},defaultOptions:{padding:["15px","15px","15px","15px"],image:"assets/340x145.jpg",width:"340",backgroundColor:"#ffffff",altTag:"",linkTo:{type:"none",typeOptions:["link","email","none"],link:""},text:'<p style="line-height: 20px;margin:0">Lorem ipsum dolor sit amet, consectetur adipisci elit, sed eiusmod tempor incidunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam.</p>'},template:'<table class="main" width="100%" cellspacing="0" cellpadding="0" border="0" bgcolor="{{element.options.backgroundColor}}" align="center">\n                  <tbody>\n                    <tr style="padding: {{ element.options.padding | arrToPadding }}; display: table-cell; font-family: Arial; font-size: 13px; color: #000000; line-height: 20px;">\n                      <td width="295">\n                        <img image-with-link link="element.options.linkTo" border="0" ng-src="{{ element.options.image }}" width="{{ element.options.width }}" style="display: block;margin: 0px;max-width: 100%;padding:0;">\n                      </td>\n                      <td width="10"></td>\n                      <td width="295" valign="top" ui-tinymce="tinymceOptions" ng-model="element.options.text"></td>\n                    </tr>\n                  </tbody>\n                </table>'},imageTextLeft:{type:"imageTextLeft",sort:7,element:{type:"imageTextLeft",icon:"format_textdirection_r_to_l",primary_head:"builder_el_image_text_left",second_head:"builder_el_image_text_left_comment"},defaultOptions:{padding:["15px","15px","15px","15px"],image:"assets/340x145.jpg",width:"340",backgroundColor:"#ffffff",altTag:"",linkTo:{type:"none",typeOptions:["link","email","none"],link:""},text:'<p style="line-height: 20px;margin:0"">Lorem ipsum dolor sit amet, consectetur adipisci elit, sed eiusmod tempor incidunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam.</p>'},template:'<table class="main" width="100%" cellspacing="0" cellpadding="0" border="0" bgcolor="{{element.options.backgroundColor}}" align="center">\n                    <tbody>\n                      <tr style="padding: {{ element.options.padding | arrToPadding }}; display: table-cell; font-family: Arial; font-size: 13px; color: #000000; line-height: 20px;">\n                        <td width="295" valign="top" ui-tinymce="tinymceOptions" ng-model="element.options.text"></td>\n                        <td width="10px"></td>\n                        <td width="295">\n                          <img image-with-link link="element.options.linkTo" border="0" ng-src="{{ element.options.image }}" width="{{ element.options.width }}" style="display: block;margin: 0px;max-width: 100%;padding:0;">\n                        </td>\n                      </tr>\n                    </tbody>\n                  </table>'},imageText2x2:{type:"imageText2x2",sort:8,element:{type:"imageText2x2",icon:"text_fields",primary_head:"builder_el_image_text_2x2",second_head:"builder_el_image_text_2x2_comment"},defaultOptions:{padding:["15px","15px","15px","15px"],image1:"assets/255x154.jpg",image2:"assets/255x154.jpg",width1:"255",width2:"255",backgroundColor:"#ffffff",altTag1:"",altTag2:"",linkTo1:{type:"none",typeOptions:["link","email","none"],link:""},linkTo2:{type:"none",typeOptions:["link","email","none"],link:""},text1:'<p style="line-height: 20px;margin:0"">Lorem ipsum dolor sit amet, consectetur adipisci elit, sed eiusmod tempor incidunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur. Quis aute iure reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint obcaecat cupiditat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. </p>',text2:'<p style="line-height: 20px;margin:0"">Lorem ipsum dolor sit amet, consectetur adipisci elit, sed eiusmod tempor incidunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur. Quis aute iure reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint obcaecat cupiditat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. </p>'},template:'<table class="main" width="100%" cellspacing="0" cellpadding="0" border="0" bgcolor="{{element.options.backgroundColor}}" align="center" data-type="imageText2x2Template">\n                    <tbody style="display: table-cell;padding: {{ element.options.padding | arrToPadding }}">\n                      <tr>\n                        <td width="295" style="padding-left: 5px;"> \n                          <img image-with-link link="element.options.linkTo1" ng-src="{{ element.options.image1 }}" width="{{ element.options.width1 }}" alt="{{element.options.altTag1}}" style="max-width: 100%" border="0">\n                        </td>\n                        <td width="10"></td>\n                        <td width="295" style="padding-right: 5px;"> \n                          <img image-with-link link="element.options.linkTo2" ng-src="{{ element.options.image2 }}" width="{{ element.options.width2 }}" alt="{{element.options.altTag2}}" style="max-width: 100%" border="0">                \n                        </td>\n                      </tr>\n                      <tr>\n                        <td width="295" align="left" style="font-family: Arial;font-size: 13px;color: #000000;line-height: 20px;padding-left: 5px;" ui-tinymce="tinymceOptions" ng-model="element.options.text1"></td>\n                        <td width="10"></td>\n                        <td width="295" align="left" style="font-family: Arial;font-size: 13px;color: #000000;line-height: 20px;padding-right: 5px;" ui-tinymce="tinymceOptions" ng-model="element.options.text2"></td>\n                      </tr>\n                    </tbody>\n                  </table>'},imageText3x2:{type:"imageText3x2",sort:9,element:{type:"imageText3x2",icon:"wrap_text",primary_head:"builder_el_image_text_3x2",second_head:"builder_el_image_text_3x2_comment"},defaultOptions:{padding:["15px","15px","15px","15px"],image1:"assets/154x160.jpg",image2:"assets/154x160.jpg",image3:"assets/154x160.jpg",width1:"154",width2:"154",width3:"154",backgroundColor:"#ffffff",altTag1:"",altTag2:"",altTag3:"",linkTo1:{type:"none",typeOptions:["link","email","none"],link:""},linkTo2:{type:"none",typeOptions:["link","email","none"],link:""},linkTo3:{type:"none",typeOptions:["link","email","none"],link:""},text1:'<p style="line-height: 20px;margin:0"">Lorem ipsum dolor sit amet, consectetur adipisci elit, sed eiusmod tempor incidunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur. Quis aute iure reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint obcaecat cupiditat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. </p>',text2:'<p style="line-height: 20px;margin:0"">Lorem ipsum dolor sit amet, consectetur adipisci elit, sed eiusmod tempor incidunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur. Quis aute iure reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint obcaecat cupiditat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. </p>',text3:'<p style="line-height: 20px;margin:0"">Lorem ipsum dolor sit amet, consectetur adipisci elit, sed eiusmod tempor incidunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur. Quis aute iure reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint obcaecat cupiditat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. </p>'},template:'<table width="100%" class="main" cellspacing="0" cellpadding="0" border="0" bgcolor="{{element.options.backgroundColor}}" align="center" data-type="imageText3x2">\n                    <tbody>\n                      <tr>\n                        <td valign="top" width="100%">\n                          <div style="display: flex; padding: {{ element.options.padding | arrToPadding }};">\n                            <div style="flex: 1 1 100%; display: flex; flex-direction: column;padding: 0 3px;">\n                              <img style="max-width: 100%; padding-bottom: 3px;display: block;margin: 0 auto;" image-with-link link="element.options.linkTo1" ng-src="{{ element.options.image1 }}" width="{{ element.options.width1 }}" alt="{{element.options.altTag1}}" border="0">\n                              <div style="font-family: Arial, serif; font-size: 13px; color: #000000; line-height: 20px" ui-tinymce="tinymceOptions" ng-model="element.options.text1"></div>\n                            </div>\n                            <div style="flex: 1 1 100%; display: flex; flex-direction: column;padding: 0 3px;">\n                              <img style="max-width: 100%; padding-bottom: 3px;display: block;margin: 0 auto;" image-with-link link="element.options.linkTo2" ng-src="{{ element.options.image2 }}" width="{{ element.options.width2 }}" alt="{{element.options.altTag2}}" border="0">\n                              <div style="font-family: Arial, serif; font-size: 13px; color: #000000; line-height: 20px" ui-tinymce="tinymceOptions" ng-model="element.options.text2"></div>\n                            </div>\n                            <div style="flex: 1 1 100%; display: flex; flex-direction: column;padding: 0 3px;">\n                              <img style="max-width: 100%; padding-bottom: 3px;display: block;margin: 0 auto;" image-with-link link="element.options.linkTo3" ng-src="{{ element.options.image3 }}" width="{{ element.options.width3 }}" alt="{{element.options.altTag3}}" border="0">\n                              <div style="font-family: Arial, serif; font-size: 13px; color: #000000; line-height: 20px" ui-tinymce="tinymceOptions" ng-model="element.options.text3"></div>\n                            </div>\n                          </div>\n                        </td>\n                      </tr>\n                    </tbody>\n                  </table>'}}};"undefined"!=typeof module&&(module.exports=emailBuilderConfigurations),angular.module("email.auth",[]),angular.module("email.main",[]),angular.module("email.directives",[]),angular.module("email.filters",[]),angular.module("email",["ngRoute","ngMaterial","angular-jwt","angular-storage","email.auth","email.main","email.directives","email.filters"]).config(["$locationProvider","jwtInterceptorProvider","$routeProvider","$httpProvider",function(e,t,i,n){i.otherwise({redirectTo:"/"}),e.hashPrefix("!")}]).run(["$rootScope","store","jwtHelper","$location",function(e,t,i,n){e.$on("$routeChangeStart",function(e,o){o.data&&o.data.requiresLogin&&(t.get("jwt")&&!i.isTokenExpired(t.get("jwt"))||(e.preventDefault(),t.remove("jwt"),n.path("/login")))})}]),angular.module("email.directives").controller("mediaUpload",["$scope","$mdDialog",function(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()},e.answer=function(e){t.hide(e)}}]),angular.module("email.directives",["ngRoute",angularDragula(angular),"pascalprecht.translate","ui.tinymce","ngSanitize","ngAlertify","colorpicker.module"]).constant("variables",emailBuilderConfigurations).value("uiTinymceConfig",{baseUrl:emailBuilderConfigurations.tinymceBaseUrl,format:"raw"}).directive("mdInput",["$timeout",function(e){return{restrict:"A",controller:["$scope","$element",function(e,t){var i=$(t);e.updateInput=function(){i.closest(".md-input-wrapper").removeClass("md-input-wrapper-danger md-input-wrapper-success md-input-wrapper-disabled"),i.hasClass("md-input-danger")&&i.closest(".md-input-wrapper").addClass("md-input-wrapper-danger"),i.hasClass("md-input-success")&&i.closest(".md-input-wrapper").addClass("md-input-wrapper-success"),i.prop("disabled")&&i.closest(".md-input-wrapper").addClass("md-input-wrapper-disabled"),i.hasClass("label-fixed")&&i.closest(".md-input-wrapper").addClass("md-input-filled"),""!==i.val()&&i.closest(".md-input-wrapper").addClass("md-input-filled")}}],link:function(t,i,n){var o=$(i);e(function(){o.hasClass("md-input-processed")||(o.prev("label").length?o.prev("label").addBack().wrapAll('<div class="md-input-wrapper"/>'):o.wrap('<div class="md-input-wrapper"/>'),o.addClass("md-input-processed").closest(".md-input-wrapper").append('<span class="md-input-bar"/>')),t.updateInput()},100),t.$watch(function(){return o.attr("class")},function(e,i){e!=i&&t.updateInput()}),t.$watch(function(){return o.val()},function(e,i){o.is(":focus")||e==i||t.updateInput()}),o.on("focus",function(){o.closest(".md-input-wrapper").addClass("md-input-focus")}).on("blur",function(){e(function(){o.closest(".md-input-wrapper").removeClass("md-input-focus"),""===o.val()?o.closest(".md-input-wrapper").removeClass("md-input-filled"):o.closest(".md-input-wrapper").addClass("md-input-filled")},100)})}}}]).directive("inputFileUpload",["utils","variables","$timeout","$mdDialog",function(e,t,i,n){return{restrict:"E",replace:!0,scope:{element:"=",model:"="},template:'\n                    <div>\n                        <div class="upload">\n                            <div class="current-image">\n                                <img ng-src="{{thumb || model}}" alt="" />\n                            </div>\n                            <div class="upload-image">\n                                <p>Upload an image</p>\n                                <a onclick="return false" href="#">Browse</a>\n                            </div>\n                            <div class="uploading">\n                                <i class="material-icons icon-spin">hdr_strong</i>\n                            </div>\n                        </div>\n                        <input type="text" class="md-input" ng-model="model" />\n                    </div>\n                ',link:function(e,t,i){var o=$(t).find(".upload-image a");$(t).find(".uploading");o.on("click",function(e){e.preventDefault(),n.show({controller:"mediaUpload",templateUrl:"directives/builder/media-upload/template.html",targetEvent:e,parent:angular.element(document.body),clickOutsideToClose:!0})})}}}]).directive("imageWithLink",[function(){return{restrict:"A",transclude:!0,scope:{link:"="},link:function(e,t,i){e.$watch(function(){return e.link.type},function(i){"none"!==i?($(t).unwrap("a"),$(t).wrap($("<a/>",{href:"link"==i?e.link.link:"mailto:"+e.link.link,target:"_blank"}).on("click",function(e){e.preventDefault()}))):$(t).unwrap("a")}),e.$watch(function(){return e.link.link},function(i){$(t).closest("a").attr("href","link"==e.link.type?i:"mailto:"+i)})}}}]).directive("colorInput",function(){return{restrict:"E",replace:!0,template:'\n                <div>\n                    <div class="current-color" ng-style="{ backgroundColor: model }"></div>\n                    <input ng-model="model" colorpicker colorpicker-position="top" type="text" />\n                </div>\n            ',scope:{model:"="},link:function(e,t,i){$(t).on("click",".current-color",function(){return $(t).find("input:text").click()}),$(t).find("input:text").on("focus",function(){$(t).addClass("focussed")}).on("focusout",function(){$(t).removeClass("focussed")})}}}).directive("mobilePreview",["$timeout",function(e){return{restrict:"E",replace:!0,scope:{email:"="},template:'\n                <iframe width="320"></iframe>\n            ',link:function(t,i,n){t.insertHtml=function(e){i[0].contentWindow.document.open(),i[0].contentWindow.document.write(e),i[0].contentWindow.document.close()},e(function(){t.$watch(function(){return t.email.html},t.insertHtml)})}}}]).filter("arrToPadding",function(){return function(e){var t="";return e.forEach(function(e){t+=e?e+" ":"0 "}),t}}).filter("hexToRgb",function(){return function(e,t){var i=e.replace("#","");i=i.match(new RegExp("(.{"+i.length/3+"})","g"));for(var n=0;n<i.length;n++)i[n]=parseInt(1==i[n].length?i[n]+i[n]:i[n],16);return void 0!==t&&(t/=100,i.push(t)),"rgba("+i.join(",")+")"}}).filter("translateCamelCase",["utils",function(e){return function(t,i){if("string"!=typeof t)return t;var n=e.camelToSnake(t),o=e.translate(n,i);return o===n?t:o}}]).filter("rawHtml",["$sce",function(e){var t=document.createElement("div");return function(i,n){return n?(t.innerHTML=i,e.trustAsHtml(t.textContent)):e.trustAsHtml(i)}}]).factory("utils",["$filter","alertify","variables",function(e,t,i){var n=this;return n.utils={translate:function(t,i){return e("translate")(t,i)},snakeToCamel:function(e){return"string"!=typeof e?e:e.replace(/_([a-z])/gi,function(e,t){return""+t.toUpperCase()})},camelToSnake:function(e){return"string"!=typeof e?e:e.replace(/([A-Z])/g,function(e,t){return"_"+t.toLowerCase()})},uid:function(e){return(e||"id")+(new Date).getTime()+"RAND"+Math.ceil(1e5*Math.random())},findWhere:function(e,t){for(var i,n,o=0,a=e.length,l=!1;o<a;o++){i=e[o];for(n in t)if(t.hasOwnProperty(n)){if(!i.hasOwnProperty(n)){l=!1;break}if(t[n]!==i[n]){l=!1;break}l=!0}if(l)return i}return null},createEmail:function(e){e=e||{};var t={tagName:"mjml",children:[{tagName:"mj-head",children:[{tagName:"mj-title",content:e.name},{tagName:"mj-style",attributes:{},content:"@media all and (max-width: 480px) {\n                                    td {\n                                        width: 100%!important;\n                                    }\n                                }"}]},{tagName:"mj-body",attributes:{},children:[{tagName:"mj-container",attributes:{"background-color":e.emailSettings.options.backgroundColor},children:[{tagName:"mj-wrapper",attributes:{"padding-top":e.emailSettings.options.paddingTop,"padding-right":e.emailSettings.options.paddingRight,"padding-bottom":e.emailSettings.options.paddingBottom,"padding-left":e.emailSettings.options.paddingLeft},children:e.elements.map(function(e){switch(e.type){case"title":return{tagName:"mj-section",attributes:{"full-width":"full-width","background-color":e.options.backgroundColor,padding:e.options.padding[0]+" "+e.options.padding[1]+" "+e.options.padding[2]+" "+e.options.padding[3]},children:[{tagName:"mj-column",attributes:{width:"100%"},children:[{tagName:"mj-text",attributes:{color:e.options.color,align:e.options.align,padding:0,"font-family":e.options.font.family,"line-height":0},content:'<h1 style="font-weight: '+e.options.font.weight+';font-size: 32px;line-height: 1;margin: 0;">'+e.options.title+"</h1>"}]},{tagName:"mj-column",attributes:{width:"100%"},children:[{tagName:"mj-text",attributes:{color:e.options.color,align:e.options.align,padding:0,"font-family":e.options.font.family},content:'<h4 style="font-weight: '+e.options.font.weight+';margin-bottom: 0;font-size: 16px;">'+e.options.subTitle+"</h4>"}]}]};case"button":return{tagName:"mj-section",attributes:{"full-width":"full-width","background-color":e.options.backgroundColor,padding:0},children:[{tagName:"mj-column",attributes:{width:"100%"},children:[{tagName:"mj-button",attributes:{align:e.options.align,border:e.options.border.size+"px "+e.options.border.style+" "+e.options.border.color,"border-radius":e.options.border.radius+"px","background-color":e.options.buttonBackgroundColor,"font-family":""+e.options.font.family,color:e.options.font.color,"font-size":e.options.font.size+"px","font-weight":e.options.font.weight,width:Boolean(e.options.fullWidth)?"100%":"auto",padding:e.options.margin[0]+" "+e.options.margin[1]+" "+e.options.margin[2]+" "+e.options.margin[3],"inner-padding":e.options.padding[0]+" "+e.options.padding[1]+" "+e.options.padding[2]+" "+e.options.padding[3],href:e.options.url},content:e.options.buttonText}]}]};case"text":return{tagName:"mj-section",attributes:{"full-width":"full-width","background-color":e.options.backgroundColor,padding:e.options.padding[0]+" "+e.options.padding[1]+" "+e.options.padding[2]+" "+e.options.padding[3]},children:[{tagName:"mj-column",children:[{tagName:"mj-text",attributes:{"font-size":"13px",color:"rgb(0, 0, 0)","line-height":"20px",padding:0,"font-family":e.options.font.family},content:e.options.text}]}]};case"divider":return{tagName:"mj-section",attributes:{"full-width":"full-width",padding:0},children:[{tagName:"mj-column",children:[{tagName:"mj-divider",attributes:{padding:e.options.padding[0]+" "+e.options.padding[1]+" "+e.options.padding[2]+" "+e.options.padding[3],"container-background-color":e.options.backgroundColor,"border-width":e.options.border.size+"px","border-style":""+e.options.border.style,"border-color":""+e.options.border.color}}]}]};case"image":return{tagName:"mj-section",attributes:{"full-width":"full-width","background-color":e.options.backgroundColor,padding:e.options.padding[0]+" "+e.options.padding[1]+" "+e.options.padding[2]+" "+e.options.padding[3]},children:[{tagName:"mj-column",children:[{tagName:"mj-image",attributes:{align:e.options.align,src:e.options.image,alt:e.options.altTag,width:e.options.width,padding:0,
href:"link"===e.options.linkTo.type&&e.options.linkTo.link||"email"===e.options.linkTo.type&&"mailto:"+e.options.linkTo.link||null}}]}]};case"imageTextRight":return{tagName:"mj-section",attributes:{"full-width":"full-width","background-color":e.options.backgroundColor,padding:e.options.padding[0]+" "+e.options.padding[1]+" "+e.options.padding[2]+" "+e.options.padding[3]},children:[{tagName:"mj-column",children:[{tagName:"mj-image",attributes:{align:e.options.align,src:e.options.image,alt:e.options.altTag,padding:0,"padding-right":"5px",width:e.options.width,href:"link"===e.options.linkTo.type&&e.options.linkTo.link||"email"===e.options.linkTo.type&&"mailto:"+e.options.linkTo.link||null}}]},{tagName:"mj-column",children:[{tagName:"mj-text",attributes:{"font-size":"13px",color:"rgb(0, 0, 0)","line-height":"20px",padding:0,"padding-left":"5px","font-family":"Arial, sans-serif"},content:e.options.text}]}]};case"imageTextLeft":return{tagName:"mj-section",attributes:{"full-width":"full-width","background-color":e.options.backgroundColor,padding:e.options.padding[0]+" "+e.options.padding[1]+" "+e.options.padding[2]+" "+e.options.padding[3]},children:[{tagName:"mj-column",children:[{tagName:"mj-text",attributes:{"font-size":"13px",color:"rgb(0, 0, 0)","line-height":"20px",padding:0,"padding-right":"5px","font-family":"Arial, sans-serif"},content:e.options.text}]},{tagName:"mj-column",children:[{tagName:"mj-image",attributes:{align:e.options.align,src:e.options.image,alt:e.options.altTag,padding:0,"padding-left":"5px",width:e.options.width,href:"link"===e.options.linkTo.type&&e.options.linkTo.link||"email"===e.options.linkTo.type&&"mailto:"+e.options.linkTo.link||null}}]}]};case"imageText2x2":return{tagName:"mj-section",attributes:{"full-width":"full-width","background-color":e.options.backgroundColor,padding:e.options.padding[0]+" "+e.options.padding[1]+" "+e.options.padding[2]+" "+e.options.padding[3]},children:[{tagName:"mj-column",children:[{tagName:"mj-image",attributes:{src:e.options.image1,alt:e.options.altTag1,padding:"0 5px",width:e.options.width1,href:"link"===e.options.linkTo1.type&&e.options.linkTo1.link||"email"===e.options.linkTo1.type&&"mailto:"+e.options.linkTo1.link||null}},{tagName:"mj-text",attributes:{"font-size":"13px",color:"rgb(0, 0, 0)","line-height":"20px",padding:"0 5px","font-family":"Arial, sans-serif"},content:e.options.text1}]},{tagName:"mj-column",children:[{tagName:"mj-image",attributes:{src:e.options.image2,alt:e.options.altTag2,padding:"0 5px",width:e.options.width2,href:"link"===e.options.linkTo2.type&&e.options.linkTo2.link||"email"===e.options.linkTo2.type&&"mailto:"+e.options.linkTo2.link||null}},{tagName:"mj-text",attributes:{"font-size":"13px",color:"rgb(0, 0, 0)","line-height":"20px",padding:"0 5px","font-family":"Arial, sans-serif"},content:e.options.text2}]}]};case"imageText3x2":return{tagName:"mj-section",attributes:{"full-width":"full-width","background-color":e.options.backgroundColor,padding:e.options.padding[0]+" "+e.options.padding[1]+" "+e.options.padding[2]+" "+e.options.padding[3]},children:[{tagName:"mj-column",children:[{tagName:"mj-image",attributes:{src:e.options.image1,alt:e.options.altTag1,padding:"0 3px 3px",width:e.options.width1,href:"link"===e.options.linkTo1.type&&e.options.linkTo1.link||"email"===e.options.linkTo1.type&&"mailto:"+e.options.linkTo1.link||null}},{tagName:"mj-text",attributes:{"font-size":"13px",color:"rgb(0, 0, 0)","line-height":"20px",padding:"0 3px","font-family":"Arial, sans-serif"},content:e.options.text1}]},{tagName:"mj-column",children:[{tagName:"mj-image",attributes:{src:e.options.image2,alt:e.options.altTag2,padding:"0 3px 3px",width:e.options.width2,href:"link"===e.options.linkTo2.type&&e.options.linkTo2.link||"email"===e.options.linkTo2.type&&"mailto:"+e.options.linkTo2.link||null}},{tagName:"mj-text",attributes:{"font-size":"13px",color:"rgb(0, 0, 0)","line-height":"20px",padding:"0 3px","font-family":"Arial, sans-serif"},content:e.options.text2}]},{tagName:"mj-column",children:[{tagName:"mj-image",attributes:{src:e.options.image3,alt:e.options.altTag3,padding:"0 3px 3px",width:e.options.width3,href:"link"===e.options.linkTo3.type&&e.options.linkTo3.link||"email"===e.options.linkTo3.type&&"mailto:"+e.options.linkTo3.link||null}},{tagName:"mj-text",attributes:{"font-size":"13px",color:"rgb(0, 0, 0)","line-height":"20px",padding:"0 3px","font-family":"Arial, sans-serif"},content:e.options.text3}]}]};case"social":var t="";return Object.keys(e.options.links).forEach(function(n){e.options.links[n].active&&(t+='<a href="'+e.options.links[n].link+'" target="_blank" style="border: none;text-decoration: none;">\n                                                                <img border="0" src="'+i.assetsPath+"/social/"+n+'.png">\n                                                             </a>')}),{tagName:"mj-section",attributes:{"full-width":"full-width","background-color":e.options.backgroundColor,padding:e.options.padding[0]+" "+e.options.padding[1]+" "+e.options.padding[2]+" "+e.options.padding[3]},children:[{tagName:"mj-column",attributes:{width:"100%"},children:[{tagName:"mj-text",attributes:{color:e.options.color,align:e.options.align,padding:0,"font-family":"Arial, sans-serif","line-height":0},content:t}]}]};default:return!1}})}]}]}]};return new Promise(function(e,n){return i.mjmlCompileAdress||i.mjmlPublicKey&&i.mjmlApplicationId?i.mjmlPublicKey&&i.mjmlApplicationId?$.ajax({url:"https://api.mjml.io/v1/render",method:"POST",data:JSON.stringify({mjml:JSON.stringify(t)}),datatype:"json",processData:!1,beforeSend:function(e){e.setRequestHeader("Authorization","Basic "+btoa(i.mjmlApplicationId+":"+i.mjmlPublicKey))},success:function(t){return e(t)}}):$.post(i.mjmlCompileAdress,JSON.stringify(t)).then(e):n("You did'nt include compile address for MJML or MJML API keys!")})},notify:function(e,i){return{log:function(){return t.log(e,i)},success:function(){t.success(e,i)},error:function(){t.error(e,i)}}},confirm:function(e,i,n,o,a){return t.okBtn(o).cancelBtn(a).confirm(e,i,n)},alert:function(e){return t.okBtn("Accept").alert(e)},prompt:function(e,i,n,o){return t.defaultValue(e).prompt(i,n,o)},validateEmail:function(e){return angular.isObject(e)&&angular.isArray(e.elements)&&angular.isString(e.html)&&angular.isObject(e.emailSettings)&&"emailSettings"==e.emailSettings.type&&angular.isObject(e.emailSettings.options)},trackEvent:function(e,t,n){return i.trackEvents&&window.ga?window.ga("send","event",e,t,n):i.trackEvents&&!window.ga?console.info("To track events, add Google UA in config.json file!"):void 0},removeLineBreaks:function(e){return e.replace(/\n\s*\n/gi,"\n")}},n.utils}]).factory("storage",["utils","variables","$http","store","jwtHelper","$location","$rootScope",function(e,t,i,n,o,a,l){"use strict";var r=n.get("jwt"),s=r&&o.decodeToken(r),d={name:t.defaults.newEmailName,elements:[],html:"",emailSettings:{options:t.defaults.emailOptions,type:"emailSettings"}},m=this;return m.opts={get:function(t){return new Promise(function(n,o){try{if("create"==t){var l={is_template:0,template:JSON.parse(JSON.stringify(d))};n(l)}else i.post("/emails/"+t,{user_id:s.id}).then(function(e){var t=e.data;t.template=JSON.parse(decodeURI(t.template))||d,n(t)},function(t){e.notify(t.data).error(),a.path("/emails")})}catch(t){e.notify(t).error()}})},put:function(t,n){return new Promise(function(o,a){try{t.html=e.removeLineBreaks(t.html);var r;"create"==n?(r={template:encodeURI(JSON.stringify(t)),user_id:s.id,object_email:l.objectEmail.object_email,cible:l.objectEmail.cible,ref_traffic:l.objectEmail.ref_traffic,desinscription:l.objectEmail.desinscription},i.post("/emails/create",r).then(function(e){o(e.data)},function(t){e.notify(t.data).error()})):(r={id:n,template:encodeURI(JSON.stringify(t)),object_email:l.objectEmail.object_email,cible:l.objectEmail.cible,ref_traffic:l.objectEmail.ref_traffic,desinscription:l.objectEmail.desinscription},i.post("/emails/update",r).then(function(e){o()},function(t){e.notify(t.data).error()}))}catch(t){e.notify(t).error(),a(t)}})},delete:function(){return new Promise(function(e,t){e(JSON.parse(JSON.stringify(d)))})}},m.opts}]).config(["$translateProvider","$translatePartialLoaderProvider","$sceDelegateProvider","$compileProvider","variables",function(e,t,i,n,o){i.resourceUrlWhitelist(["self"]),n.debugInfoEnabled(!1),t.addPart("builder"),e.useLoader("$translatePartialLoader",{urlTemplate:o.translateTemplateUrl}),e.preferredLanguage("en"),e.useSanitizeValueStrategy("sanitize"),e.fallbackLanguage("en"),e.useSanitizeValueStrategy("escape")}]).run(["$templateCache","variables",function(e,t){Object.keys(t.blocks).forEach(function(i){return-1===t.disableBlocks.indexOf(i)&&e.put(t.blocks[i].type+"Template",t.blocks[i].template)})}]).directive("emailBuilder",["variables",function(e){return{restrict:"E",templateUrl:"directives/builder/layouts/"+e.defaultLayout+"/builder.html",controller:["$scope","$rootScope","utils","storage","dragulaService","$interpolate","$translate","$templateCache","variables","$routeParams","store","$location",function(e,t,i,n,o,a,l,r,s,d,m,p){e.email_id=d.id,e.detailEnable=!1,t.$watch("selectedTemplate",function(t){t&&t>0&&e.getEmailTemplate(t)}),e.backToElements=function(){e.detailEnable=!1},e.getEmailTemplate=function(i){var o={object_email:"",cible:"",ref_traffic:"",desinscription:""};n.get(i).then(function(i){e.Email=JSON.parse(JSON.stringify(i.template)),e.cloneEmail=JSON.parse(JSON.stringify(i.template)),1==i.is_template?t.objectEmail=o:t.objectEmail={object_email:i.object_email,cible:i.cible,ref_traffic:i.ref_traffic,desinscription:i.desinscription},e.$evalAsync(function(){e.currentElement=e.Email.emailSettings})})},e.getEmailTemplate(e.email_id),e.elements=Object.keys(s.blocks).map(function(e){return s.blocks[e].element}).sort(function(e,t){return s.blocks[e.type].sort-s.blocks[t.type].sort}).filter(function(e){return-1===s.disableBlocks.indexOf(e.type)}),e.getVariable=function(e){return s[e]},e.currentLanguage="en",e.tinymceOptions={inline:!0,skin:"lightgray",theme:"modern",plugins:["advlist autolink lists link image charmap","searchreplace visualblocks code","insertdatetime media table contextmenu paste","textcolor"],toolbar:"undo redo | bold italic fontsizeselect forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist | link",fontsize_formats:"8pt 9pt 10pt 11pt 12pt 13pt 14pt 15pt 16pt 18pt 24pt 36pt"},s.includeMailchimpMergeTags&&(e.tinymceOptions=angular.extend(e.tinymceOptions,{setup:function(e){e.addButton("mailchimpMergeTags",{type:"menubutton",text:"Merge Tags",icon:!1,menu:["*|FNAME|*","*|LNAME|*","*|EMAIL|*","*|LIST:NAME|*","*|LIST:COMPANY|*","*|LIST:SUBSCRIBERS|*","*|USER:COMPANY|*","*|USER:ADDRESS|*","*|USER:PHONE|*","*|MC:DATE|*","*|CURRENT_YEAR|*","*|UNSUB|*","*|UPDATE_PROFILE|*"].map(function(t){return{text:t,onclick:function(){e.insertContent(t)}}})})}})),e.addSocialNetwork=function(e,t){t&&(e[t].active=!0)},e.getTemplate=function(e){return e?e+"Template":"textTemplate"},e.removeElement=function(t){return i.confirm(i.translate("are_you_sure"),function(){var n=i.findWhere(e.Email.elements,{id:t});e.Email.elements.splice(e.Email.elements.indexOf(n),1),i.trackEvent("Elements","remove",n.type),e.currentElement=e.Email.emailSettings,e.$apply()},null,i.translate("delete_element"),i.translate("do_not_remove_element"))},e.cloneElement=function(t){var n=i.findWhere(e.Email.elements,{id:t}),o=JSON.parse(JSON.stringify(n));o.id=i.uid(),i.trackEvent("Elements","clone",o.type),e.Email.elements.splice(e.Email.elements.indexOf(n)+1,0,o)},e.editElement=function(t){if(e.detailEnable=!0,!t)return e.currentElement=e.Email.emailSettings;e.preview||(e.currentElement="emailSettings"!=t?i.findWhere(e.Email.elements,{id:t}):e.Email[t],e.currentElement&&i.trackEvent("Email","edit",e.currentElement.type))},e.changeLanguage=function(t){return e.currentLanguage=t,l.use(t)},e.hasChanges=function(){return!angular.equals(e.Email,e.cloneEmail)},e.saveEmailTemplate=function(){i.createEmail(e.Email).then(function(t){if(t.errors.length)return i.notify(t.errors.map(function(e){return e.message}).join("<br>")).error();e.Email.html=t.html,n.put(e.Email,e.email_id).then(function(t){i.notify(i.translate("email_saved")).success(),i.trackEvent("Email","saved"),e.cloneEmail=JSON.parse(JSON.stringify(e.Email)),e.$evalAsync(function(){e.currentElement=e.Email.emailSettings}),"create"==e.email_id&&p.path("/emails/"+t.insertId)})},function(e){return i.notify(e).error()})},e.openExportContainer=function(){if(!e.Email.elements.length)return i.notify(i.translate("nothing_to_export")).log();e.exportAsHtml=!1,e.currentElement="export"},e.exportEmailAsJson=function(){var t=document.createElement("a");t.target="_blank",i.trackEvent("Email","export","JSON"),t.href="data:attachment/json,"+encodeURI(JSON.stringify(e.Email)),t.download=i.uid("export")+".json",document.body.appendChild(t),t.click(),document.body.removeChild(t)},e.downloadHtml=function(){var t=document.createElement("a");t.target="_blank",i.trackEvent("Email","export","HTML"),t.href="data:attachment/html,"+encodeURI(e.Email.html),t.download=i.uid("export")+".html",document.body.appendChild(t),t.click(),document.body.removeChild(t)},e.importEmail=function(){var t=$("<input />",{type:"file",name:"import-file"}).on("change",function(){var t=new FileReader;t.onload=function(){var o=JSON.parse(t.result);i.validateEmail(o)?(i.trackEvent("Email","import"),e.$evalAsync(function(){e.currentElement=void 0,e.Email=o,e.cloneEmail=JSON.parse(JSON.stringify(o))}),i.notify(i.translate("email_has_been_imported",{lastModified:new Date(n.lastModified).toLocaleString()})).success()):i.notify(i.translate("imported_data_isnt_valid")).error()};var n=this.files[0];if("json"!==n.name.slice(-4))return i.notify(i.translate("invalid_format_file")).log();t.readAsText(n)});return e.Email.elements.length?i.confirm(i.translate("before_import"),function(){return t.click()},function(){return i.notify(i.translate("import_canceled")).log()},i.translate("accept"),i.translate("deny")):t.click()},e.previewEmail=function(){if(!e.Email.elements.length)return i.notify(i.translate("nothing_to_preview")).log();i.trackEvent("Email","preview"),e.preview=!0,e.currentElement=void 0},e.$watch("preview",function(e){tinymce.editors.forEach(function(t){return t[e?"hide":"show"]()})}),e.mobilePreview=!1,e.deleteAllElements=function(){return i.confirm(i.translate("before_delete_all_elements"),function(){return n.delete().then(function(t){e.$evalAsync(function(){e.currentElement=void 0,e.Email=t,e.cloneEmail=JSON.parse(JSON.stringify(t))})})},null,i.translate("accept"),i.translate("deny"))},o.options(e,"element",{isContainer:function(e){return e.classList.contains("email-content")},copy:!0,copySortSource:!1,removeOnSpill:!0,moves:function(e,t,i,n){return!$(t).hasClass("email-content")},invalid:function(e,t){return!1}}),o.options(e,"element-html",{copy:!1,copySortSource:!1,moves:function(e,t,i,n){return $(i).hasClass("move")},invalid:function(e,t){return!1}}),e.$on("element.drop",function(t,n,o,a,l){var r=$(n).data("type"),d=$.extend(!0,{},{type:r,options:s.blocks[r].defaultOptions});d.id=i.uid();var m=$(l).index();$(".email-content li").remove(),-1==m?e.Email.elements.push(d):e.Email.elements.splice(m-1,0,d),i.trackEvent("Elements","drop",d.type),e.$apply()}),e.$on("element-html.drop",function(t,n,o,a,l){var r=$(n).attr("id"),s=$(l).index();-1==s?s=e.Email.elements.length-1:s--;var d=i.findWhere(e.Email.elements,{id:r}),m=e.Email.elements.indexOf(d);if(s>=e.Email.elements.length)for(var p=s-e.Email.elements.length;1+p--;)e.Email.elements.push(void 0);return e.Email.elements.splice(s,0,e.Email.elements.splice(m,1)[0]),e.$apply(),!1})}]}}]),angular.module("email.directives").constant("variables",emailBuilderConfigurations).directive("emailsList",function(){return{restrict:"E",templateUrl:"directives/sidebar/list/list.html",controller:["$scope","$http","store","jwtHelper",function(e,t,i,n){e.user_emails={},e.init=function(){t.get("/emails/non_templates").then(function(t){e.filterEmails(t.data)},function(t){e.error=t.data})},e.filterEmails=function(t){for(var o,a,l=i.get("jwt"),r=l&&n.decodeToken(l),s=r.fName+" "+r.lName,d={},m=0;m<t.length;m++)o=t[m],d[o.user_id]||(a=o.fName+" "+o.lName,a==s&&r.id==o.user_id&&(a="My"),d[o.user_id]={name:a,emails:[]}),d[o.user_id].emails.push(o);e.user_emails=angular.copy(d)},e.init()}]}}),angular.module("email.directives").constant("variables",emailBuilderConfigurations).directive("emailsSample",function(){return{restrict:"E",templateUrl:"directives/sidebar/samples/template.html",controller:["$scope","$http","$rootScope",function(e,t,i){e.sample_templates=[],i.selectedTemplate=0,e.init=function(){t.get("/emails/templates").then(function(t){e.sample_templates=t.data},function(t){e.error=t.data})},e.selectTemplate=function(e){i.selectedTemplate=e},e.init()}]}}),angular.module("email.directives").constant("variables",emailBuilderConfigurations).directive("objectEmail",function(){return{restrict:"E",templateUrl:"directives/sidebar/object-email/template.html",controller:["$scope","$rootScope",function(e,t){t.objectEmail={object_email:"",cible:"",ref_traffic:"",desinscription:""}}]}}),angular.module("email.directives").constant("variables",emailBuilderConfigurations).directive("emailsSidebar",function(){return{restrict:"E",templateUrl:"directives/sidebar/sidebar.html",controller:["$scope","$rootScope","$routeParams",function(e,t,i){e.selectedIndex=0,"create"==i.id?e.selectedIndex=1:i.id>0&&(e.selectedIndex=2),t.$watch("selectedTemplate",function(t){t&&t>0&&(e.selectedIndex=2)})}]}}),angular.module("email.directives").constant("variables",emailBuilderConfigurations).directive("emailsNavbar",function(){return{restrict:"E",templateUrl:"directives/navbar/navbar.html",controller:["$scope",function(e){}]}}),angular.module("email.main").constant("variables",emailBuilderConfigurations).config(["$routeProvider","$locationProvider","variables",function(e,t,i){e.when("/",{templateUrl:i.containerPath+"/container.html",controller:"emailsContainerCtrl",data:{requiresLogin:!0}}).when("/emails",{templateUrl:i.containerPath+"/container.html",controller:"emailsContainerCtrl",data:{requiresLogin:!0}}).when("/emails/:id",{templateUrl:i.containerPath+"/container.html",controller:"emailsContainerCtrl",data:{requiresLogin:!0}})}]).controller("emailsContainerCtrl",["$scope","$location","$http","store","jwtHelper","$routeParams",function(e,t,i,n,o,a){e.email_block=!1,e.email_id=a.id,angular.isDefined(e.email_id)&&(e.email_block=!0),e.logout=function(){n.remove("jwt"),t.path("/")}}]),angular.module("email.auth",[]).constant("variables",emailBuilderConfigurations).config(["$routeProvider","$locationProvider","variables",function(e,t,i){e.when("/login",{templateUrl:i.authPath+"/login.html",controller:"loginCtrl"}).when("/register",{templateUrl:i.authPath+"/register.html",controller:"registerCtrl"})}]).controller("loginCtrl",["$scope","$http","variables","store","$location",function(e,t,i,n,o){n.get("jwt")&&o.path("/emails"),e.error="",e.login=function(){0!=e.loginForm.$valid&&t.post("/auth/login",e.user).then(function(e){n.set("jwt",e.data.id_token),o.path("/emails")},function(t){e.error=t.data})}}]).controller("registerCtrl",["$scope","$http","variables","store","$location",function(e,t,i,n,o){n.get("jwt")&&o.path("/emails"),e.error="",e.register=function(){0!=e.signupForm.$valid&&t.post("/auth/register",e.user).then(function(e){n.set("jwt",e.data.id_token),o.path("/emails")},function(t){e.error=t.data})}}]),angular.module("email.filters").filter("templateName",function(){return function(e){return""!=e?JSON.parse(decodeURI(e)).name:""}});